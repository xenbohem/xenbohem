<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valxentine CafÃ©</title>
<!-- Appwrite SDK -->
<script src="https://cdn.jsdelivr.net/npm/appwrite@9.9.0/dist/appwrite.min.js"></script>

<style>
:root{
  --blush:#FFC1CC;
  --rose:#FF6B81;
  --punch:#FF3B5C;
  --soft-bg:#FFF0F5;
  --text-dark:#4B2E3E;
  --accent:#FF69B4;
  --heart-color:#FFB6C1;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:'Sawarabi Mincho', cursive;
  background:linear-gradient(135deg,var(--soft-bg),#ffe6f0);
  display:flex;
  justify-content:center;
  align-items:flex-start;
  min-height:100vh;
  overflow-x:hidden;
}

#cafe-frame{
  width:90vw;
  max-width:900px;
  min-height:90vh;
  background:rgba(255,255,255,0.9);
  border-radius:20px;
  box-shadow:0 0 60px rgba(0,0,0,0.25);
  padding:20px;
  overflow-y:auto;
  position:relative;
}

#header{
  font-size:2rem;
  text-align:center;
  margin-bottom:20px;
  color:var(--rose);
  text-shadow:0 0 6px var(--punch);
}

/* Welcome Note */
#welcome-note{
  background:var(--blush);
  padding:12px 16px;
  border-radius:12px;
  margin-bottom:16px;
  cursor:pointer;
  transition:0.3s all;
  max-height:500px;
  overflow:hidden;
}
#welcome-note.collapsed{
  max-height:3em;
}

/* Daily Prompt */
#daily-prompt{
  background:var(--rose);
  color:white;
  padding:10px 14px;
  border-radius:10px;
  margin-bottom:16px;
  font-size:1.1rem;
}

/* Posts Board */
#posts{
  display:flex;
  flex-direction:column-reverse;
  gap:12px;
}

.post{
  background:rgba(255,255,255,0.6);
  padding:10px 14px;
  border-radius:10px;
  border-left:4px solid var(--punch);
}

.post-author{
  font-weight:bold;
  color:var(--accent);
  margin-bottom:4px;
}

/* Input */
#post-input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  margin-top:8px;
}

#post-btn{
  padding:8px 14px;
  background:var(--punch);
  color:white;
  border:none;
  border-radius:10px;
  margin-top:8px;
  cursor:pointer;
}

/* Music Cup */
#music-cup{
  position:fixed;
  bottom:20px;
  right:20px;
  font-size:2rem;
  cursor:pointer;
}
#music-player{
  position:fixed;
  bottom:70px;
  right:20px;
  background:rgba(255,192,203,0.9);
  padding:12px;
  border-radius:12px;
  display:none;
}

/* Floating hearts */
.heart{
  position:absolute;
  width:12px;
  height:12px;
  background:var(--heart-color);
  transform:rotate(45deg);
  animation:float 4s linear infinite;
  opacity:0.8;
}
.heart::after,
.heart::before{
  content:'';
  position:absolute;
  width:12px;
  height:12px;
  background:var(--heart-color);
  border-radius:50%;
}
.heart::after{top:-6px; left:0;}
.heart::before{left:-6px; top:0;}
@keyframes float{
  0%{transform:translateY(0) rotate(45deg);}
  100%{transform:translateY(-200px) rotate(45deg);}
}
</style>

<link href="https://fonts.googleapis.com/css2?family=Sawarabi+Mincho&display=swap" rel="stylesheet">

</head>
<body>

<div id="cafe-frame">
  <div id="header">â˜• Welcome to Valxentine CafÃ© â˜•</div>

  <div id="welcome-note" class="collapsed">
    Hello sweet visitor! ðŸ’—<br>
    Here at Valxentine CafÃ© we explore **love, gratitude, and daily joy**.<br>
    Your heart and spirit are welcome here. Tap to expand/collapse this note.
  </div>

  <div id="daily-prompt">ðŸ’Œ Today's Love Prompt: Take a moment to appreciate something beautiful in your day.</div>

  <div id="posts"></div>

  <input id="post-input" placeholder="Share your love noteâ€¦" />
  <button id="post-btn">Post</button>
</div>

<div id="music-cup">â˜•</div>
<div id="music-player">
  <audio id="audio-player" controls src="music/track1.mp3"></audio>
</div>

<script>
// -----------------------------
// Floating hearts
// -----------------------------
function createHeart(){
  const heart = document.createElement('div');
  heart.className='heart';
  heart.style.left=Math.random()*window.innerWidth+'px';
  heart.style.animationDuration=2+Math.random()*3+'s';
  document.body.appendChild(heart);
  setTimeout(()=>heart.remove(),4000);
}
setInterval(createHeart,300);

// -----------------------------
// Welcome note collapsible
// -----------------------------
const welcomeNote = document.getElementById('welcome-note');
const firstVisit = localStorage.getItem('firstVisit');
if(!firstVisit){
  welcomeNote.classList.remove('collapsed');
  localStorage.setItem('firstVisit','seen');
}
welcomeNote.onclick = ()=>welcomeNote.classList.toggle('collapsed');

// -----------------------------
// Music cup toggle
// -----------------------------
const cup = document.getElementById('music-cup');
const player = document.getElementById('music-player');
cup.onclick = ()=>player.style.display=(player.style.display==='none'?'block':'none');

// -----------------------------
// Appwrite setup
// -----------------------------
const client = new Appwrite.Client();
client
    .setEndpoint('https://sfo.cloud.appwrite.io/v1') // replace
    .setProject('698453930017e185ce48'); // replace

const database = new Appwrite.Database(client);
const collectionId = 'jotnotes'; // your collection

// Elements
const postsContainer = document.getElementById('posts');
const postBtn = document.getElementById('post-btn');
const postInput = document.getElementById('post-input');
const userInput = { value: 'Anonymous' }; // you can later bind to a real login

// -----------------------------
// Load all notes
// -----------------------------
async function loadPosts(){
  postsContainer.innerHTML='';
  try{
    const res = await database.listDocuments(collectionId);
    const docs = res.documents.sort((a,b)=>new Date(a.$createdAt)-new Date(b.$createdAt));
    docs.forEach(doc=>{
      const div = document.createElement('div');
      div.className='post';
      div.innerHTML = `<div class="post-author">${doc.author || 'Anonymous'} â€” ${new Date(doc.$createdAt).toLocaleString()}</div>${doc.content}`;
      postsContainer.appendChild(div);
    });
  }catch(err){console.error(err);}
}

// -----------------------------
// Add new note
// -----------------------------
postBtn.onclick=async ()=>{
  const content = postInput.value.trim();
  if(!content) return;
  try{
    await database.createDocument(collectionId,{
      author:userInput.value,
      content:content
    });
    postInput.value='';
    loadPosts();
  }catch(err){console.error(err);}
}

// Initial load
loadPosts();
</script>

</body>
</html>
